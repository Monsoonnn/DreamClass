using UnityEngine;
using TMPro;
using System.Collections.Generic;

public class GuideStepManager : SingletonCtrl<GuideStepManager>
{
    [Header("UI")]
    public TextMeshProUGUI titleText;
    public TextMeshProUGUI descriptionText;

    [Header("Steps")]
    public List<StepData> steps = new List<StepData>();

    private StepData currentStep;


    /// <summary>
    /// Activate a step by ID
    /// </summary>
    public void ActivateStep( string stepID ) {
        StepData step = steps.Find(s => s.stepID == stepID);
        if (step == null) {
            Debug.LogWarning($"[StepManager] Step '{stepID}' not found!");
            return;
        }

        currentStep = step;
        Debug.Log($"[StepManager] Activated step: {step.stepID}");

        // Update UI
        if (titleText != null) titleText.text = step.title;
        if (descriptionText != null) descriptionText.text = step.description;

        // Highlight target (optional)
        HighlightTarget(step.highlightTarget);

        // Trigger event
        step.onStepStart?.Invoke();
    }

    /// <summary>
    /// Mark the current step as completed
    /// </summary>
    public void CompleteCurrentStep() {
        if (currentStep == null) {
            Debug.LogWarning("[StepManager] No active step to complete!");
            return;
        }

        Debug.Log($"[StepManager] Completed step: {currentStep.stepID}");
        currentStep.onStepComplete?.Invoke();
        currentStep = null;
    }

    private void HighlightTarget( GameObject obj ) {
        if (obj == null) return;
        // You can add Outline or glow logic here
        Debug.Log($"Highlight: {obj.name}");
    }
}
